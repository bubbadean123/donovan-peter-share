#! /usr/bin/env ruby
require "tapedrive"
if ARGV[0] == "-h" or ARGV[0] == "--help"
  puts "Interface program for tapedrive"
  puts "List of operations:"
  puts "Case sensitive!"
  puts "i:"
  puts "Insert a new tape. Takes a tape name."
  puts "e:"
  puts "Ejects the current tape."
  puts "w:"
  puts "Write to the tape. Takes a string and a starting postion. Returns the location of the string."
  puts "r:"
  puts "Read from the tape. Takes a starting position and an ending position."
  puts "s:"
  puts "Stop the program."
  exit
end
op = ""
drive = TapeDrive.new()

while op != "s" or op != "S"
  puts "Op:"
  op = gets.chomp
  case op
    when "i"
      puts "Name:"
      name = gets.chomp
      drive.insert(name)
    when "e"
      drive.eject()
    when "w"
      puts "Data:"
      data = gets.chomp
      puts "Start:"
      start = gets.chomp.to_i
      drive.write(data,start)
      puts "Location:"
      puts "#{start}-#{start+data.length-1}"
    when "r"
      puts "Start:"
      start = gets.chomp.to_i
      puts "End:"
      end_pos = gets.chomp.to_i
      puts drive.read(start,end_pos)
    when "s"
    drive.flush()
    drive.eject()
   end   

end

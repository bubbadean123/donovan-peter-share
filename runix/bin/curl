RUNIX=true
if RUNIX
	args=[]
	args[0]="localhost:2000"
	args[1]="/"
	args[2]="index.html"
else
	args=ARGV
end
require "socket"
addr=args[0].split(":")
if addr.length==1
	puts "curl: Address must be in format host:port"
	exit
end
begin
	server=TCPSocket.new(addr[0],addr[1])
  file=File.open(args[2],"w")
	hfile=File.open(args[2].split(".")[0]+".head","w")
rescue => e
	puts e
	exit
else
end
server.puts "GET #{args[1]}"
server.puts "\r\n"
endhead=false
while data=server.gets
	if endhead
		puts "Body:#{data}"
		file.puts data
	else
		if data=="\n"
			puts "End of header"
			endhead=true
		else
			puts "Header:#{data}"
			hfile.puts data
		end
	end
end
server.close
file.close
hfile.close